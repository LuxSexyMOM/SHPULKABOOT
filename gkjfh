-- Delta Executor: CallieStarPets Ultimate Script
-- Автоматическая ферма ресурсов + улучшенный GUI

local Players = game:GetService("Players")
local LocalPlayer = Players.LocalPlayer
local RunService = game:GetService("RunService")
local UserInputService = game:GetService("UserInputService")
local Workspace = game:GetService("Workspace")
local ReplicatedStorage = game:GetService("ReplicatedStorage")

-- Конфигурация
getgenv().Config = {
    AutoFarm = false,
    AutoSell = false,
    AutoCollect = false,
    WalkSpeed = 16,
    JumpPower = 50,
    AntiAFK = true,
    InfJump = false
}

-- Создаем GUI
local ScreenGui = Instance.new("ScreenGui")
if syn then syn.protect_gui(ScreenGui) end
ScreenGui.Parent = game.CoreGui

local Main = Instance.new("Frame")
local Title = Instance.new("TextLabel")
local Drag = Instance.new("Frame")
local Tabs = Instance.new("Frame")
local Body = Instance.new("Frame")
local UICorner = Instance.new("UICorner")

-- Настройка GUI
ScreenGui.Name = "DeltaMenu"

Main.Name = "Main"
Main.Size = UDim2.new(0, 400, 0, 300)
Main.Position = UDim2.new(0.5, -200, 0.5, -150)
Main.BackgroundColor3 = Color3.fromRGB(25, 25, 35)
Main.BorderSizePixel = 0
Main.Parent = ScreenGui

UICorner.CornerRadius = UDim.new(0, 8)
UICorner.Parent = Main

Title.Name = "Title"
Title.Size = UDim2.new(1, 0, 0, 40)
Title.BackgroundColor3 = Color3.fromRGB(35, 35, 50)
Title.BackgroundTransparency = 0.5
Title.Text = "Δ CallieStarPets Executor v2.0"
Title.TextColor3 = Color3.fromRGB(0, 255, 255)
Title.Font = Enum.Font.GothamBold
Title.TextSize = 18
Title.Parent = Main

Drag.Name = "Drag"
Drag.Size = UDim2.new(1, 0, 0, 40)
Drag.BackgroundTransparency = 1
Drag.Parent = Main

Tabs.Name = "Tabs"
Tabs.Size = UDim2.new(0, 100, 1, -40)
Tabs.Position = UDim2.new(0, 0, 0, 40)
Tabs.BackgroundColor3 = Color3.fromRGB(30, 30, 40)
Tabs.Parent = Main

Body.Name = "Body"
Body.Size = UDim2.new(1, -100, 1, -40)
Body.Position = UDim2.new(0, 100, 0, 40)
Body.BackgroundColor3 = Color3.fromRGB(20, 20, 25)
Body.Parent = Main

-- Функция для создания кнопок вкладок
local function createTab(name, color)
    local tab = Instance.new("TextButton")
    tab.Name = name
    tab.Size = UDim2.new(1, 0, 0, 40)
    tab.BackgroundColor3 = color
    tab.BorderSizePixel = 0
    tab.Text = name
    tab.TextColor3 = Color3.fromRGB(255, 255, 255)
    tab.Font = Enum.Font.Gotham
    tab.TextSize = 14
    tab.Parent = Tabs
    
    return tab
end

-- Создаем вкладки
local tabs = {
    {name = "Ферма", color = Color3.fromRGB(60, 120, 60)},
    {name = "Игрок", color = Color3.fromRGB(120, 60, 60)},
    {name = "Авто", color = Color3.fromRGB(60, 60, 120)},
    {name = "Другое", color = Color3.fromRGB(120, 120, 60)}
}

for i, tabData in ipairs(tabs) do
    local tab = createTab(tabData.name, tabData.color)
    tab.Position = UDim2.new(0, 0, 0, (i-1)*40)
end

-- Функции фермы
local farmFunctions = {
    autoFarmResources = function()
        while getgenv().Config.AutoFarm do
            -- Поиск ресурсов
            for _, item in pairs(Workspace:GetChildren()) do
                if item:IsA("Model") and item.Name:find("Ore") then
                    local char = LocalPlayer.Character
                    if char then
                        local humanoid = char:FindFirstChildOfClass("Humanoid")
                        local root = char:FindFirstChild("HumanoidRootPart")
                        
                        if humanoid and root then
                            -- Телепортация к ресурсу
                            root.CFrame = item.PrimaryPart.CFrame
                            wait(0.5)
                            
                            -- Эмуляция клика
                            mouse1click()
                            wait(0.2)
                        end
                    end
                end
            end
            wait(1)
        end
    end,
    
    autoSellItems = function()
        -- Поиск NPC для продажи
        for _, npc in pairs(Workspace:GetChildren()) do
            if npc:IsA("Model") and npc.Name:find("Merchant") then
                local char = LocalPlayer.Character
                if char then
                    local root = char:FindFirstChild("HumanoidRootPart")
                    if root then
                        root.CFrame = npc.PrimaryPart.CFrame
                        wait(1)
                        
                        -- Нажатие E для взаимодействия
                        keypress(0x45) -- E key
                        wait(0.1)
                        keyrelease(0x45)
                    end
                end
            end
        end
    end
}

-- Создаем элементы управления
local function createToggle(name, configKey, parent)
    local frame = Instance.new("Frame")
    local label = Instance.new("TextLabel")
    local toggle = Instance.new("TextButton")
    
    frame.Size = UDim2.new(1, -20, 0, 30)
    frame.BackgroundTransparency = 1
    frame.Parent = parent
    
    label.Size = UDim2.new(0.7, 0, 1, 0)
    label.Text = name
    label.TextColor3 = Color3.fromRGB(255, 255, 255)
    label.Font = Enum.Font.Gotham
    label.TextSize = 12
    label.TextXAlignment = Enum.TextXAlignment.Left
    label.BackgroundTransparency = 1
    label.Parent = frame
    
    toggle.Size = UDim2.new(0, 50, 0, 20)
    toggle.Position = UDim2.new(1, -50, 0.5, -10)
    toggle.Text = getgenv().Config[configKey] and "ON" : "OFF"
    toggle.BackgroundColor3 = getgenv().Config[configKey] and Color3.fromRGB(0, 255, 0) : Color3.fromRGB(255, 0, 0)
    toggle.Parent = frame
    
    toggle.MouseButton1Click:Connect(function()
        getgenv().Config[configKey] = not getgenv().Config[configKey]
        toggle.Text = getgenv().Config[configKey] and "ON" or "OFF"
        toggle.BackgroundColor3 = getgenv().Config[configKey] and Color3.fromRGB(0, 255, 0) or Color3.fromRGB(255, 0, 0)
        
        -- Запуск функции если нужно
        if configKey == "AutoFarm" and getgenv().Config[configKey] then
            spawn(farmFunctions.autoFarmResources)
        end
    end)
    
    return frame
end

-- Заполняем вкладку Ферма
local farmBody = Instance.new("ScrollingFrame")
farmBody.Size = UDim2.new(1, -10, 1, -10)
farmBody.Position = UDim2.new(0, 5, 0, 5)
farmBody.BackgroundTransparency = 1
farmBody.ScrollBarThickness = 5
farmBody.Parent = Body

local farmList = Instance.new("UIListLayout")
farmList.Parent = farmBody

createToggle("Авто-Ферма", "AutoFarm", farmBody)
createToggle("Авто-Продажа", "AutoSell", farmBody)
createToggle("Авто-Сбор", "AutoCollect", farmBody)

-- Функция для перемещения GUI
local dragging = false
local dragStart, startPos

Drag.InputBegan:Connect(function(input)
    if input.UserInputType == Enum.UserInputType.MouseButton1 then
        dragging = true
        dragStart = input.Position
        startPos = Main.Position
        
        input.Changed:Connect(function()
            if input.UserInputState == Enum.UserInputState.End then
                dragging = false
            end
        end)
    end
end)

UserInputService.InputChanged:Connect(function(input)
    if dragging and input.UserInputType == Enum.UserInputType.MouseMovement then
        local delta = input.Position - dragStart
        Main.Position = UDim2.new(startPos.X.Scale, startPos.X.Offset + delta.X, startPos.Y.Scale, startPos.Y.Offset + delta.Y)
    end
end)

-- Горячие клавиши
UserInputService.InputBegan:Connect(function(input, processed)
    if not processed then
        if input.KeyCode == Enum.KeyCode.Insert then
            Main.Visible = not Main.Visible
        elseif input.KeyCode == Enum.KeyCode.Delete then
            ScreenGui:Destroy()
        end
    end
end)

print("┌─────────────────────────────────────────┐")
print("│    CallieStarPets Delta Executor v2.0   │")
print("├─────────────────────────────────────────┤")
print("│  Insert - Показать/Скрыть меню          │")
print("│  Delete - Удалить меню                  │")
print("│  Drag - Перетаскивать за верхнюю часть  │")
print("└─────────────────────────────────────────┘")
